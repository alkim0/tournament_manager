{% extends "tmdb/base.html" %}

{% block main-content %}
<div class="row page-header">
    {% if error_form %}
    <div class="alert alert-danger">
    {{error_form.as_p}}
    </div>
    {% endif %}
    <h1 class="col-sm-5 col-md-5">Schools List at {{tournament.location}} on {{tournament.date}}</h1>
    <form action="{% url 'tmdb:tournament_schools' tournament.slug %}" method="post">
        <input type="hidden" name="tournament_slug" value="{{tournament.slug}}"/>
        {% csrf_token %}
        {{import_all_form.school_registrations}}
        {{import_all_form.reimport}}
        <input class="col-sm-offset-2 col-sm-3 col-md-offset-3 col-md-3 btn btn-primary" type="submit" value="Import All Schools"/>
    </form>
  </div>
  <table class="table table-striped">
    <thead>
    <th> School Name </th>
    <th> Import URL </th>
    <th> Status </th>
    <th> Import </th>
    </thead>
  {% for school in schools %}
    <tr>
      <td><a href="{% url 'tmdb:tournament_school' tournament.slug school.organization.slug %}">{{school.organization.name}}</a></td>
      <td><a href="{{school.registration_doc_url}}">Google Docs Registration spreadsheet</a></td>
      <td>
          {% if school.imported %}
          <p>Imported</p>
          {% else %}
          <p>Not Imported</p>
          {% endif %}
      </td>
      <td>
        <form action="{% url 'tmdb:tournament_schools' tournament.slug %}" method="post">
          <input type="hidden" name="tournament_slug" value="{{tournament.slug}}"/>
          {% csrf_token %}
          {{ school.import_form.school_registrations }}
          {{ school.import_form.reimport }}
          {% if school.imported %}
          <button class="btn btn-warning" input type="submit"> Re-import Teams </button>
          {% else %}
          <button class="btn btn-primary" input type="submit"> Import Teams </button>
          {% endif %}
        </form>
      </td>

    </tr>
  {% endfor %}
  </table>
{% endblock %}
