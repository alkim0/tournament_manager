{% extends "tmdb/base.html" %}

{% block main-content %}
<div class="row page-header">
    {% if error_form %}
    <div class="alert alert-danger">
    {{error_form.as_p}}
    </div>
    {% endif %}
    <h1 class="col-sm-5 col-md-5">Schools List at {{tournament.location}} on {{tournament.date}}</h1>
    {% if all_schools_imported %}
        <div class="col-sm-offset-2 col-sm-3 col-md-offset-3 col-md-3 btn btn-success"/>
        All schools imported
        </div>
    {% else %}
    <form action="{% url 'tmdb:tournament_schools' tournament.slug %}" method="post">
        <input type="hidden" name="tournament_slug" value="{{tournament.slug}}"/>
        {% csrf_token %}
        {{import_all_form.school_registrations}}
        {{import_all_form.reimport}}
        <input class="col-sm-offset-2 col-sm-3 col-md-offset-3 col-md-3 btn btn-primary" type="submit" value="Import All Schools"/>
    </form>
    {% endif %}
  </div>
  <a href="{% url 'tmdb:tournament_dashboard' tournament.slug %}" class="btn btn-primary" input type="submit">Go to Tournament Dashboard</a>
  <table class="table table-striped">
    <thead>
    <th> School Name </th>
    <th> Import URL </th>
    <th> Status </th>
    <th> Import </th>
    </thead>
  {% for school_reg in school_registrations %}
    <tr>
      <td><a href="{% url 'tmdb:tournament_school' tournament.slug school_reg.school.slug %}">{{school_reg.school.name}}</a></td>
      <td><a href="{{school_reg.registration_doc_url}}">Google Docs Registration spreadsheet</a></td>
      <td>
          {% if school_reg.imported %}
          <p>Imported</p>
          {% else %}
          <p>Not Imported</p>
          {% endif %}
      </td>
      <td>
        <form action="{% url 'tmdb:tournament_schools' tournament.slug %}" method="post">
          <input type="hidden" name="tournament_slug" value="{{tournament.slug}}"/>
          {% csrf_token %}
          {{ school_reg.import_form.school_registrations }}
          {{ school_reg.import_form.reimport }}
          {% if school_reg.imported %}
          <button class="btn btn-warning" input type="submit"> Re-import Teams </button>
          {% else %}
          <button class="btn btn-primary" input type="submit"> Import Teams </button>
          {% endif %}
        </form>
      </td>

    </tr>
  {% endfor %}
  </table>
{% endblock %}
